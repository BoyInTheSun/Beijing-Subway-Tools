# Beijing Subway
| 线路        | 版本    | 更新时间       | 方向              | Chart     |
|-----------|-------|------------|-----------------|-----------|
| 1号线       | 新11版  | 2023-06-03 | ~~东行~~ ~~西行~~   | ~~Chart~~ |
| 2号线       | 新4版   | 2023-06-03 | ~~外环~~ ~~内环~~   | ~~Chart~~ |
| 4号线       | 第4版   | 2023-11-14 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 5号线       | 新4版   | 2022-11-05 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 6号线       | 新8版   | 2023-09-07 | ~~东行~~ ~~西行~~   | ~~Chart~~ |
| 7号线       | 新8版   | 2023-08-02 | ~~东行~~ ~~西行~~   | ~~Chart~~ |
| 8号线       | 新8版   | 2023-09-11 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 9号线       | 新8版   | 2023-09-11 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 10号线      | 新4版   | 2022-07-22 | ~~外环~~ ~~内环~~   | ~~Chart~~ |
| 11号线      | 新3版   | 2023-11-10 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 13号线      | 新4版   | 2021-04-09 | ~~东行~~ ~~西行~~   | ~~Chart~~ |
| 14号线      | 第2版   | 2023-05-31 | ~~东北行~~ ~~西南行~~ | ~~Chart~~ |
| 15号线      | 新6版   | 2023-05-29 | ~~东行~~ ~~西行~~   | ~~Chart~~ |
| 16号线      | 第6版   | 2023-11-12 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 17号线      | 第1版   | 2022-06-23 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 19号线      | 第4版   | 2023-04-18 | ~~南行~~ ~~北行~~   | ~~Chart~~ |
| 亦庄线       | 新2版   | 2020-09-06 | ~~进城~~ ~~出城~~   | ~~Chart~~ |
| 房山线       | 新8版   | 2023-09-11 | ~~进城~~ ~~出城~~   | ~~Chart~~ |
| 燕房线       | 第2版   | 2023-04-18 | ~~进城~~ ~~出城~~   | ~~Chart~~ |
| S1线       | 新4版   | 2021-12-31 | ~~进城~~ ~~出城~~   | ~~Chart~~ |
| 昌平线       | 新11版  | 2023-09-07 | ~~进城~~ ~~出城~~   | ~~Chart~~ |
| 西郊线       | 第1版   | 2023-10-05 | ~~进城~~ ~~出城~~   | ~~Chart~~ |
| ~~亦庄T1线~~ | （不做了） |
| 首都机场线     | 新5版   | 2023-01-18 | ~~进城~~ ~~出城~~   | ~~Chart~~ |
| 大兴机场线     | 第2版   | 2023-04-27 | ~~进城~~ ~~出城~~   | ~~Chart~~ |


# Taipei Metro
台北+新北+桃园捷运。包括机场捷运，淡水轻轨，安坑轻轨，不包括维修中的环状线，台铁/高铁。数据来源：
- 时刻表（目前版本：2023/11公布）
  - R/G/O/BL: [台北捷运官方网站](https://www.metro.taipei/cp.aspx?n=91974F2B13D997F1)
  - BR: MetroMan地铁通非官方时刻表
  - 两条轻轨: [新北捷运官方网站](https://www.ntmetro.com.tw/basic/?mode=detail&node=460)
  - 机场捷运: [桃园捷运官方网站](https://www.tymetro.com.tw/tymetro-new/tw/_pages/travel-guide/timetable.php)
- 换乘时间: [Blog](https://blog.transtaiwan.com/blog/transfer-time-settings/)
- 各站站间距: [PTT](https://www.ptt.cc/bbs/MRT/M.1342435699.A.99B.html)


# Enhancements
- [x] 快车实现：正常记录过站时间，但是不允许上车（显示passing/通过）
- [x] 东西南北 East West South North 桥 Bridge ...
- [x] 多音字处理：十里堡 pu 朝阳门 chao
- avg_shortest Min/Max显示
  - [x] 出发时间 （或许显示route时直接显示起终时间更好？)
  - [x] 每个径路的示例时间
- [x] First/Last Train显示线路
- [x] 末班车First/Last Leaving Train
- [x] Train type/carriage number (etc 6B) + 设计速度
- [x] 部分节点低峰时段允许逆行（Special Rules）
- [x] 文档：每个py文件的参数说明
- [x] 旅速：per line & average (+min/max)
- [x] 表格版per line旅速（+站间距，首末站，每天列车数量等等）
- [x] 每天列车数量，总运行距离，总运量，总车距离，总人距离
- [x] 最快/最慢车排除某些线路（比如有鬼）
- [x] Per minute train count graph
- [x] 最长/短站间距
- [x] Moving Average: 每30/60min最高/低运量/列车数
- [x] Add total row to highest_speed
- [x] Add include/exclude support to highest_speed
- [x] 站/区间断面30/60min最高/低运量/列车数
- [x] Embed include_edge into options
- [x] 和环线相似的快车专门分析：平均速度，平均用时，同区间快多少，越行几次
- [x] show_loop扩展到普通线路（出库-折返-回库）
- [x] 数字编号排序
- [x] 最早/最晚路径
- [x] contour vs contourf调整
- [x] 环线加入出库车自动判定（注：目前无法实现时刻表中标注，只有算出列车后的标注）
- [x] Allow sort by multiple columns
- [x] 优化avg_shortest，每分钟更改为每列车开始
- [x] ~~多线程与~~进度条
- [x] 拆分highest_speed，改名city_statistics
- [x] --exclude-edge扩展到首/末班车
- [x] 各类表格的CSV输出
- [x] 虚拟换乘
- [x] 跨线车支持 (注：BFS暂不支持，仅支持查看；用0分钟换乘模拟)
- [x] 最短路增强：~~最少换乘~~/最短距离/最短站数
- [x] 支持画图中显示平均换乘次数/平均距离/平均站数
- [x] 多起点画图
- [ ] 到某线路的画图（比如到10号线的平均时间）
- [x] 画图contour强调选项-f
- [ ] 区间旅速比较（某区间的旅速比其他区间快多少）
- [ ] 某线某一时刻上线列车列表及位置
  - [x] 对接[beijing-subway-schedule](https://github.com/BoyInTheSun/beijing-subway-schedule)项目
- [ ] 平均间隔，高峰平均间隔，平均全程车占比，高峰全程车占比
- [x] --reverse支持索引
- [x] --show和--hide显示/隐藏列
- [x] 换乘平均等车时间/>N min的比率 (TODO: Add example timing)
- 完善文档
  - [x] create a new line
  - [x] tools
- [ ] 中文文档
- [ ] 开通日期（optional，毕竟有换乘，wb东管头南有统计）
- [ ] Use color to represent different train routes (optional)
- [ ] 其他城市特性
  - [ ] 多语言支持
  - [x] 车站/线路编号

## 线网径路PK：对于同一个首末站组合，指定不同径路
- 指定径路：
  - [ ] 指定线路自动生成（例如5号线-1号线[西行]-4号线，或者菜单选换乘站）
  - [ ] 指定途径站
  - [ ] 最短的N个路径
  - [ ] 途经点
  - [ ] 不允许经过某站/某线
- 输出统计：
  - [ ] 每个径路占优百分比
  - [ ] 单独最短/长时间 & 例子
  - [ ] 相对最短/长时间（即#1 - #2极值）

## 高难度/远期
- [x] 多线程支持
- [ ] 反转整个图，BFS创造单终点最短路（即到某站的最短时间）
- [ ] 增强版最短路
  - [ ] 多源多汇
  - [ ] 单独附加分钟数（例如到A站出发+0min，到B站出发+3min）
- [ ] 支线支持
- [ ] 换乘系数（avg shortest）：两站之间每分钟最短时间路径的换乘次数/距离平均（顺便也添加上最短/长时间/距离）
- [ ] 忽略某条线/某站/某个换乘
- [ ] 某条线延长N站（输入站名，运行时间，如果不存在可以输入坐标）
- [ ] 运行图输出（[参考](https://www.zhihu.com/question/27281523/answer/36034502)）
- [ ] 更多城市
- [x] 最长路算法
- [x] 在地图上绘制最短路

## Known Bugs
- 本质上时刻表上的最短路是NP-Hard（因为不满足最优子结构），所以BFS其实不成立
- 虚拟换乘允许单行程内出现多次
- 多线程时进度条卡住
- BFS并不真正考虑直通车，使用0分钟换乘模拟 (Hard to fix)
- 暂时不支持以站数或者距离为基准的k-最短路
- 最少换乘路线暂未实现
